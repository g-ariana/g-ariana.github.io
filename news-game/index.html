<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Nebraskan 2048</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Inter font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            /* Prevent overscroll bounce on mobile */
            overscroll-behavior: none;
        }
        
        /* Base styles for tiles to allow for transitions */
        .game-tile {
            transition: transform 0.1s ease-in-out, background-color 0.1s ease-in-out;
        }

        /* Small text for crowded tiles */
        .text-xxs {
            font-size: 0.65rem;
            line-height: 0.9rem;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-900 flex items-center justify-center min-h-screen overscroll-none">

    <!-- Main Game Container -->
    <div class="bg-white p-4 sm:p-6 rounded-xl shadow-2xl relative overflow-hidden">
        
        <!-- Header -->
        <header class="flex justify-between items-center mb-4">
            <div>
                <h1 class="text-3xl sm:text-4xl font-black text-red-700">DN 2048</h1>
                <p class="text-sm text-gray-600">Join the tiles, build the story!</p> 
                <p class="text-sm text-gray-600">Use the arrow keys to move the tiles.</p> 
            </div>
            <div class="flex flex-col items-end space-y-2">
                <!-- Score -->
                <div class="bg-red-800 text-white p-2 px-4 rounded-lg text-center">
                    <span class="text-xs font-bold uppercase tracking-wider">Score</span>
                    <div id="score" class="text-2xl font-bold">0</div>
                </div>
                <!-- New Game Button -->
                <button id="new-game-btn" class="bg-red-600 text-white py-2 px-4 rounded-lg font-semibold hover:bg-red-700 transition-colors">
                    New Game
                </button>
            </div>
        </header>

        <!-- Game Board -->
        <div id="game-board" class="grid grid-cols-4 gap-3 sm:gap-4 bg-red-900 p-3 sm:p-4 rounded-lg">
            <!-- Tiles will be dynamically generated by JS here -->
            <!-- Example of empty cells (which are just the bg) -->
            <div class="w-16 h-16 sm:w-20 sm:h-20 bg-red-800/50 rounded-md"></div>
            <div class="w-16 h-16 sm:w-20 sm:h-20 bg-red-800/50 rounded-md"></div>
            <div class="w-16 h-16 sm:w-20 sm:h-20 bg-red-800/50 rounded-md"></div>
            <div class="w-16 h-16 sm:w-20 sm:h-20 bg-red-800/50 rounded-md"></div>
            <div class="w-16 h-16 sm:w-20 sm:h-20 bg-red-800/50 rounded-md"></div>
            <div class="w-16 h-16 sm:w-20 sm:h-20 bg-red-800/50 rounded-md"></div>
            <div class="w-16 h-16 sm:w-20 sm:h-20 bg-red-800/50 rounded-md"></div>
            <div class="w-16 h-16 sm:w-20 sm:h-20 bg-red-800/50 rounded-md"></div>
            <div class="w-16 h-16 sm:w-20 sm:h-20 bg-red-800/50 rounded-md"></div>
            <div class="w-16 h-16 sm:w-20 sm:h-20 bg-red-800/50 rounded-md"></div>
            <div class="w-16 h-16 sm:w-20 sm:h-20 bg-red-800/50 rounded-md"></div>
            <div class="w-16 h-16 sm:w-20 sm:h-20 bg-red-800/50 rounded-md"></div>
            <div class="w-16 h-16 sm:w-20 sm:h-20 bg-red-800/50 rounded-md"></div>
            <div class="w-16 h-16 sm:w-20 sm:h-20 bg-red-800/50 rounded-md"></div>
            <div class="w-16 h-16 sm:w-20 sm:h-20 bg-red-800/50 rounded-md"></div>
            <div class="w-16 h-16 sm:w-20 sm:h-20 bg-red-800/50 rounded-md"></div>
        </div>

        <!-- Game Over Modal -->
        <div id="game-over-modal" class="hidden absolute inset-0 bg-black/70 flex flex-col items-center justify-center text-white p-4">
            <h2 class="text-4xl font-black text-red-500">Game Over!</h2>
            <p class="text-lg mt-2 mb-4">You missed the deadline!</p>
            <button id="retry-btn" class="bg-red-600 text-white py-2 px-6 rounded-lg text-lg font-semibold hover:bg-red-700 transition-colors">
                Try Again
            </button>
        </div>

        <!-- Win Modal -->
        <div id="win-modal" class="hidden absolute inset-0 bg-black/70 flex flex-col items-center justify-center text-white p-4">
            <h2 class="text-4xl font-black text-yellow-400">Pulitzer!</h2>
            <p class="text-lg mt-2 mb-4">You won the big one!</p>
            <button id="keep-playing-btn" class="bg-gray-600 text-white py-2 px-6 rounded-lg text-lg font-semibold hover:bg-gray-700 transition-colors mb-2">
                Keep Playing
            </button>
            <button id="play-again-btn" class="bg-red-600 text-white py-2 px-6 rounded-lg text-lg font-semibold hover:bg-red-700 transition-colors">
                Play Again
            </button>
        </div>

    </div>

    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', () => {
            const gameBoard = document.getElementById('game-board');
            const scoreElement = document.getElementById('score');
            const newGameBtn = document.getElementById('new-game-btn');
            const gameOverModal = document.getElementById('game-over-modal');
            const winModal = document.getElementById('win-modal');
            const retryBtn = document.getElementById('retry-btn');
            const playAgainBtn = document.getElementById('play-again-btn');
            const keepPlayingBtn = document.getElementById('keep-playing-btn');

            let grid = [];
            let score = 0;
            let isWon = false;
            const gridSize = 4;

            // --- Tile Content and Styling ---

            // The content for each tile value
            const tileData = {
                0: "",
                2: "Newbie",
                4: "First Byline",
                8: "DNer of the Week",
                16: "Senior Reporter",
                32: "Assistant Editor",
                64: "Senior Editor",
                128: "Managing Editor",
                256: "Editor in Chief",
                512: "Allen Vaughan",
                1024: "Front Page",
                2048: "UNL Pulitzer",
                4096: "DN Legend",
                8192: "Press Freedom"
            };

            // Tailwind classes for each tile value
            const tileStyles = {
                0: "bg-red-800/50",
                2: "bg-red-100 text-red-900 text-xxs sm:text-xs",
                4: "bg-red-200 text-red-900 text-xxs sm:text-xs",
                8: "bg-red-300 text-white text-xxs sm:text-xs",
                16: "bg-red-400 text-white text-xxs sm:text-xs",
                32: "bg-red-500 text-white text-xxs sm:text-xs",
                64: "bg-red-600 text-white text-xxs sm:text-xs",
                128: "bg-red-700 text-white text-xxs sm:text-xs",
                256: "bg-red-800 text-white text-xxs sm:text-xs",
                512: "bg-red-900 text-white text-xxs sm:text-xs",
                1024: "bg-black text-red-300 text-xxs sm:text-xs",
                2048: "bg-yellow-400 text-black text-xxs sm:text-xs font-black",
                4096: "bg-yellow-500 text-black text-xxs sm:text-xs font-black",
                8192: "bg-yellow-600 text-black text-xxs sm:text-xs font-black",
            };

            // --- Game Initialization ---

            function initGame() {
                grid = Array(gridSize).fill(null).map(() => Array(gridSize).fill(0));
                score = 0;
                isWon = false;
                gameOverModal.classList.add('hidden');
                winModal.classList.add('hidden');
                
                addRandomTile();
                addRandomTile();
                updateScore(0);
                renderGrid();
            }

            // --- Rendering ---

            function renderGrid() {
                gameBoard.innerHTML = ''; // Clear board
                for (let r = 0; r < gridSize; r++) {
                    for (let c = 0; c < gridSize; c++) {
                        const tile = document.createElement('div');
                        const value = grid[r][c];
                        const styleKey = value > 8192 ? 8192 : value; // Use max style for higher values
                        
                        const baseClasses = "game-tile w-16 h-16 sm:w-20 sm:h-20 rounded-md flex items-center justify-center p-1 text-center font-bold transition-all duration-100";
                        const dynamicClasses = tileStyles[styleKey] || tileStyles[0];
                        
                        tile.className = `${baseClasses} ${dynamicClasses}`;
                        tile.innerText = tileData[value] || "";
                        gameBoard.appendChild(tile);
                    }
                }
            }

            function updateScore(points) {
                score += points;
                scoreElement.innerText = score;
            }

            // --- Game Logic ---

            function addRandomTile() {
                let emptyCells = [];
                for (let r = 0; r < gridSize; r++) {
                    for (let c = 0; c < gridSize; c++) {
                        if (grid[r][c] === 0) {
                            emptyCells.push({ r, c });
                        }
                    }
                }

                if (emptyCells.length > 0) {
                    const { r, c } = emptyCells[Math.floor(Math.random() * emptyCells.length)];
                    grid[r][c] = Math.random() < 0.9 ? 2 : 4;
                }
            }

            function handleInput(e) {
                // IMPORTANT: Prevent arrow keys from scrolling the page
                if (["ArrowUp", "ArrowDown", "ArrowLeft", "ArrowRight"].includes(e.key)) {
                    e.preventDefault();
                }

                let moved = false;
                switch (e.key) {
                    case "ArrowUp":
                        moved = moveUp();
                        break;
                    case "ArrowDown":
                        moved = moveDown();
                        break;
                    case "ArrowLeft":
                        moved = moveLeft();
                        break;
                    case "ArrowRight":
                        moved = moveRight();
                        break;
                    default:
                        return; // Do nothing if not an arrow key
                }

                if (moved) {
                    addRandomTile();
                    renderGrid();
                    
                    if (!isWon) {
                        checkWin();
                    }

                    if (checkGameOver()) {
                        gameOverModal.classList.remove('hidden');
                    }
                }
            }

            // --- Movement Functions ---

            // Helper function to slide and merge a single row/column
            function slide(row) {
                let newRow = row.filter(val => val !== 0); // 1. Filter out zeros
                let points = 0;
                
                // 2. Merge
                for (let i = 0; i < newRow.length - 1; i++) {
                    if (newRow[i] === newRow[i + 1]) {
                        newRow[i] *= 2;
                        points += newRow[i];
                        newRow.splice(i + 1, 1); // Remove the merged tile
                    }
                }
                
                // 3. Pad with zeros
                while (newRow.length < gridSize) {
                    newRow.push(0);
                }

                return { newRow, points };
            }

            function moveLeft() {
                let moved = false;
                for (let r = 0; r < gridSize; r++) {
                    const row = grid[r];
                    const { newRow, points } = slide([...row]);
                    if (row.join(',') !== newRow.join(',')) {
                        moved = true;
                    }
                    grid[r] = newRow;
                    updateScore(points);
                }
                return moved;
            }

            function moveRight() {
                let moved = false;
                for (let r = 0; r < gridSize; r++) {
                    const row = grid[r].reverse();
                    const { newRow, points } = slide([...row]);
                    newRow.reverse();
                    if (grid[r].join(',') !== newRow.join(',')) {
                        moved = true;
                    }
                    grid[r] = newRow;
                    updateScore(points);
                }
                return moved;
            }
            
            // Transpose the grid (rows become columns, columns become rows)
            function transpose() {
                const newGrid = Array(gridSize).fill(null).map(() => Array(gridSize).fill(0));
                for (let r = 0; r < gridSize; r++) {
                    for (let c = 0; c < gridSize; c++) {
                        newGrid[c][r] = grid[r][c];
                    }
                }
                grid = newGrid;
            }

            function moveUp() {
                transpose();
                const moved = moveLeft();
                transpose(); // Transpose back
                return moved;
            }

            function moveDown() {
                transpose();
                const moved = moveRight();
                transpose(); // Transpose back
                return moved;
            }

            // --- Win/Loss Checks ---

            function checkWin() {
                for (let r = 0; r < gridSize; r++) {
                    for (let c = 0; c < gridSize; c++) {
                        if (grid[r][c] === 2048) {
                            winModal.classList.remove('hidden');
                            isWon = true;
                            return;
                        }
                    }
                }
            }

            function canMove() {
                // Check for empty cells
                for (let r = 0; r < gridSize; r++) {
                    for (let c = 0; c < gridSize; c++) {
                        if (grid[r][c] === 0) {
                            return true;
                        }
                    }
                }
                // Check for adjacent merges
                for (let r = 0; r < gridSize; r++) {
                    for (let c = 0; c < gridSize; c++) {
                        // Check right
                        if (c < gridSize - 1 && grid[r][c] === grid[r][c + 1]) {
                            return true;
                        }
                        // Check down
                        if (r < gridSize - 1 && grid[r][c] === grid[r + 1][c]) {
                            return true;
                        }
                    }
                }
                return false;
            }

            function checkGameOver() {
                return !canMove();
            }

            // --- Event Listeners ---

            // Main game input
            window.addEventListener('keydown', handleInput);
            
            // Modal buttons
            newGameBtn.addEventListener('click', initGame);
            retryBtn.addEventListener('click', initGame);
            playAgainBtn.addEventListener('click', initGame);
            keepPlayingBtn.addEventListener('click', () => {
                winModal.classList.add('hidden');
            });

            // Start the game!
            initGame();
        });
    </script>
</body>
</html>



